<?php
require_once 'PHPUnit/Framework.php';

/**
 * Test class for Ediary_User.
 * Generated by PHPUnit on 2011-02-26 at 14:23:54.
 */
class Ediary_FileTest extends ControllerTestCase
{
    /**
     * @var Ediary_Journal
     */
    protected $object;
    
    protected $data = array();

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    protected function setUp()
    {
        parent::setUp();
        
    }

    public function dataProvider() {
        return array(
            array(
                array(
        			'user_id' => '3',
        			'filename' => 'testfile.jpg',
        			'filepath' => '/your/path/testfile.jpg',
        			'filemime' => 'image/jpg',
        			'filesize' => '12000',
                )
            ),
        );
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown()
    {
    }
    
    /** @dataProvider dataProvider */
    public function testInsert($data) {
        $file = new Ediary_File($data);
        $file->insert();
        
        foreach ($data as $key => $value) {
            $this->assertEquals($data[$key], $file->$key);
        }
    }
    
    /** @dataProvider dataProvider */
    public function testUpload($data) {
        $file = new Ediary_File($data);
        $file->insert();
        
        $newName ='newName';
        $file->filename = $newName;
        $file->update();
        
        // test find
        $fileDb = Ediary_File::find($file->id);
        $this->assertEquals($file->id, $fileDb->id);
        $this->assertEquals($newName, $fileDb->filename);
        
        // test isBelongTo
        $this->assertTrue($file->isBelongTo($data['user_id']));
        
        // test delete
        $this->assertTrue($fileDb->delete());
        $this->assertNull(Ediary_File::find($fileDb->id));
        
        
    }

}